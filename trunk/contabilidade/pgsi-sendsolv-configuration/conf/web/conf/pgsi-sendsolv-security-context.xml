<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:sec="http://www.springframework.org/schema/security"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:p="http://www.springframework.org/schema/p"
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        	http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">

	<sec:global-method-security pre-post-annotations="enabled"> </sec:global-method-security>

	<sec:http security="none" pattern="/images/page-background.png"/>
	<sec:http security="none" pattern="/images/logo.png"/>
	<sec:http security="none" pattern="/images/sendsolv.png"/>
	<sec:http security="none" pattern="/fonts/PTS55F-webfont.eot"/>
	<sec:http security="none" pattern="/fonts/PTS55F-webfont.woff"/>
	<sec:http security="none" pattern="/fonts/PTS55F-webfont.ttf"/>
	<sec:http security="none" pattern="/fonts/PTS55F-webfont.svg"/>
	<sec:http security="none" pattern="/fonts/navigation.eot"/>
	<sec:http security="none" pattern="/fonts/navigation.woff"/>
	<sec:http security="none" pattern="/fonts/navigation.ttf"/>
	<sec:http security="none" pattern="/fonts/navigation.svg"/>
	<sec:http security="none" pattern="/login.jsp*"/>
	<sec:http security="none" pattern="/ivrapi/*"/>
	<sec:http security="none" pattern="/web/*"/>
	<sec:http security="none" pattern="/audio/*/*.mp3"/>

	<sec:http auto-config="true" use-expressions="true">
		<sec:intercept-url pattern="/**/**"
			access="hasAnyRole('ROLE_DOMAIN ADMIN','ROLE_ADMIN','ROLE_CSR')" />
		<sec:form-login login-page="/login.jsp?Please Login."
			authentication-failure-url="/login.jsp?Login Failed."
			default-target-url="/"
			always-use-default-target="true" />
		<sec:logout invalidate-session="false" logout-success-url="/login.jsp?Successful Logout." />
		<sec:access-denied-handler error-page="/login.jsp?Access Denied." />
		<sec:session-management invalid-session-url="/login.jsp?Access Denied.">
			<sec:concurrency-control max-sessions="5"
				error-if-maximum-exceeded="true" />
		</sec:session-management>
	</sec:http>

	<sec:ldap-server url="ldaps://localhost:636/dc=BLDWILLCHANGE,dc=prosperitasglobal,dc=com" />

	<sec:authentication-manager erase-credentials="false">
		<sec:ldap-authentication-provider
			user-dn-pattern="uid={0},ou=Users"
			group-search-base="ou=Roles"
			user-context-mapper-ref="userContextMapper" />
	</sec:authentication-manager>

	<bean id="userContextMapper" class="org.springframework.security.ldap.userdetails.InetOrgPersonContextMapper" />

	<!-- 	<security:http Auto-config="false" Use-expressions="true" -->
<!-- 		Access-denied-page="/login.jsp?Session Timed Out." Entry-point-ref="loginUrlAuthenticationEntryPoint"> -->
<!-- 		<security:custom-filter Position="FORM_LOGIN_FILTER" Ref="customUsernamePasswordAuthenticationFilter" /> -->
<!-- 		<security:custom-filter Position="CONCURRENT_SESSION_FILTER" Ref="concurrencyFilter" /> -->
<!-- 		<security:intercept-url Pattern="/process/**" Access="isAuthenticated()" /> -->
<!-- 		<security:intercept-url Pattern="/**/**" Access="hasAnyRole('ROLE_DOMAIN ADMIN','ROLE_ADMIN','ROLE_CSR')" /> -->
<!-- 		<security:logout Invalidate-session="true" Logout-success-url="/login.jsp?Successful Logout." /> -->
<!-- 	</security:http> -->

<!--    <bean Id="concurrencyFilter" Class="org.springframework.security.web.session.ConcurrentSessionFilter"> -->
<!--      <property Name="sessionRegistry" Ref="sessionRegistry" /> -->
<!--      <property Name="expiredUrl" Value="/timeout.jsp" /> -->
<!--    </bean> -->

<!-- <!-- Custom Authentication Manager. In Order To Authenticate Username/password And Tenant --> -->
<!-- 	<bean Id="customAuthenticationManager" Class="com.sensus.lc.security.CustomAuthenticationManager"> -->
<!--     	<property Name="settingsBCF" Ref="settingsBCF" /> -->
<!-- 		<property Name="userBCF" Ref="userBCF" /> -->
<!-- 		<property Name="webSeviceUserName" Ref="webserviceUserNameTarget" /> -->
<!-- 		<property Name="webSevicePassword" Ref="webserviceUserPwdTarget" /> -->
<!-- 		<property Name="superUserName" Ref="superUserNameTarget" /> -->
<!-- 		<property Name="app" Value="slc" /> -->
<!-- 	</bean> -->

<!--  	<bean Id="customUsernamePasswordAuthenticationFilter" -->
<!-- 		Class="com.sensus.lc.security.CustomUsernamePasswordAuthenticationFilter"> -->
<!-- 		<property Name="authenticationManager" Ref="customAuthenticationManager" /> -->
<!-- 		<property Name="authenticationFailureHandler" Ref="failureHandler" /> -->
<!-- 		<property Name="sessionAuthenticationStrategy" Ref="sessionAuthenticationStrategy" /> -->
<!-- 		<property Name="authenticationSuccessHandler" Ref="successHandler" /> -->
<!-- 	</bean> -->

<!--     <bean Id="sessionRegistry" Class="org.springframework.security.core.session.SessionRegistryImpl" /> -->

<!-- 	<bean Id="sessionAuthenticationStrategy" Class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy"> -->
<!--                 <constructor-arg Name="sessionRegistry" Ref="sessionRegistry" /> -->
<!--                 <property Name="maximumSessions" Value="5" /> -->
<!--                 <property Name="exceptionIfMaximumExceeded" Value="true"/> -->
<!--     </bean> -->


<!-- 	<bean Id="successHandler" -->
<!-- 		Class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler"> -->
<!-- 		<property Name="defaultTargetUrl" Value="/main" /> -->
<!-- 		<property Name="alwaysUseDefaultTargetUrl" Value="true" /> -->
<!-- 	</bean> -->

<!-- 	<bean Id="failureHandler" -->
<!-- 		Class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"> -->
<!-- 		<property Name="defaultFailureUrl" Value="/login.jsp?error=true" /> -->
<!-- 	</bean> -->

<!-- 	<bean Id="loginUrlAuthenticationEntryPoint" -->
<!-- 		Class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint"> -->
<!-- 		<property Name="loginFormUrl" Value="/login.jsp?Please Login." /> -->
<!-- 	</bean> -->

<!-- 	<!-- Web Service Security - Callback For Interceptor --> -->
<!-- 	<bean Id="validationCallback" -->
<!-- 		Class="org.springframework.ws.soap.security.wss4j.callback.SpringPlainTextPasswordValidationCallbackHandler"> -->
<!-- 		<property Name="authenticationManager" Ref="customAuthenticationManager" /> -->
<!-- 	</bean> -->

<!-- 	<!-- Interceptor --> -->
<!-- 	<bean Id="securityInterceptor" -->
<!-- 		Class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor"> -->
<!-- 		<property Name="validationActions" Value="UsernameToken" /> -->
<!-- 		<property Name="validationCallbackHandler" Ref="validationCallback" /> -->
<!-- 	</bean> -->


<!-- 	<!-- WS Client Authentication --> -->
<!-- 	<bean Id="mlc.interceptor.authentication" -->
<!-- 		Class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor"> -->
<!-- 		<property Name="securementActions" Value="UsernameToken" /> -->
<!-- 		<property Name="securementPasswordType" Value="PasswordText" /> -->
<!-- 		<property Name="securementCallbackHandler" Ref="mlc.wss4j.securementCallback" /> -->
<!-- 	</bean> -->

<!-- 	<bean Id="mlc.wss4j.securementCallback" Class="com.sensus.lc.security.LCNotClientSecurementCallback" /> -->
</beans>