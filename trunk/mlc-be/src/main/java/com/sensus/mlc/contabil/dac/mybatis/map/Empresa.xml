<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Empresa">

	<resultMap id="EmpresasResult" type="Empresa">
		<result property="codemp" column="codemp" />
		<result property="razemp" column="razemp" />
		<result property="nomeemp" column="nomeemp" />
		<result property="cnpjemp" column="cnpjemp" />
		<result property="inscemp" column="inscemp" />
		<result property="endemp" column="endemp" />
		<result property="numemp" column="numemp" />
		<result property="complemp" column="complemp" />
		<result property="bairemp" column="bairemp" />
		<result property="cepemp" column="cepemp" />
		<result property="cidemp" column="cidemp" />
		<result property="ufemp" column="ufemp" />
		<result property="dddemp" column="dddemp" />
		<result property="foneemp" column="foneemp" />
		<result property="faxemp" column="faxemp" />
		<result property="emailemp" column="emailemp" />
		<result property="wwwemp" column="wwwemp" />
		<result property="codeanemp" column="codeanemp" />
		<result property="nomecontemp" column="nomecontemp" />
		<result property="multialmoxemp" column="multialmoxemp" />
		<result property="fotoemp" column="fotoemp" />
		<result property="codmunic" column="codmunic" />
		<result property="siglauf" column="siglauf" />
		<result property="codpais" column="codpais" />
		<result property="percissemp" column="percissemp" />
		<result property="codpaisemp" column="codpaisemp" />
		<result property="dtins" column="dtins" />
		<result property="hins" column="hins" />
		<result property="idusuins" column="idusuins" />
		<result property="dtalt" column="dtalt" />
		<result property="halt" column="halt" />
		<result property="idusualt" column="idusualt" />
		<collection property="listFilial" column="codemp"
			select="Empresa.fetchAllFiliaisById" />
		<collection property="codend" column="codend"
			select="Empresa.fetchAllEnderecoByEmpresa" />
	</resultMap>

	<resultMap id="FilialResult" type="Filial">
		<result property="codemp" column="codemp" />
		<result property="codfilial" column="codfilial" />
		<result property="razfilial" column="razfilial" />
		<result property="nomefilial" column="nomefilial" />
		<result property="mzfilial" column="mzfilial" />
		<result property="cnpjfilial" column="cnpjfilial" />
		<result property="inscfilial" column="inscfilial" />
		<result property="coddistfilial" column="coddistfilial" />
		<result property="percpisfilial" column="percpisfilial" />
		<result property="perccofinsfilial" column="perccofinsfilial" />
		<result property="percirfilial" column="percirfilial" />
		<result property="perccsocialfilial" column="perccsocialfilial" />
		<result property="simplesfilial" column="simplesfilial" />
		<result property="percsimplesfilial" column="percsimplesfilial" />
		<result property="codmunic" column="codmunic" />
		<result property="siglauf" column="siglauf" />
		<result property="codpais" column="codpais" />
		<result property="codempuc" column="codempuc" />
		<result property="codfilialuc" column="codfilialuc" />
		<result property="codunifcod" column="codunifcod" />
		<result property="inscmunfilial" column="inscmunfilial" />
		<result property="cnaefilial" column="cnaefilial" />
		<result property="percissfilial" column="percissfilial" />
		<result property="contribipifilial" column="contribipifilial" />
		<result property="timbrefilial" column="timbrefilial" />
		<result property="perfilfilial" column="perfilfilial" />
		<result property="indativfilial" column="indativfilial" />
		<result property="dtins" column="dtins" />
		<result property="hins" column="hins" />
		<result property="idusuins" column="idusuins" />
		<result property="dtalt" column="dtalt" />
		<result property="halt" column="halt" />
		<result property="idusualt" column="idusualt" />
		<result property="codempco" column="codempco" />
		<result property="codfilialco" column="codfilialco" />
		<result property="codfor" column="codfor" />
		<result property="suframa" column="suframa" />
		<result property="sedeMatriz" column="sedeMatriz" />
		<collection property="codend" column="codend"
			select="Empresa.fetchAllEnderecoByFilial" />
	</resultMap>

	<resultMap id="EnderecoResult" type="Endereco">
		<result property="codend" column="codend" />
		<result property="endereco" column="ende" />
		<result property="numero" column="num" />
		<result property="complemento" column="compl" />
		<result property="bairro" column="bair" />
		<result property="cep" column="cep" />
		<result property="cidade" column="cid" />
		<result property="uf" column="uf" />
		<result property="ddd" column="ddd" />
		<result property="fone1" column="fone" />
		<result property="fone2" column="fone" />
		<result property="email" column="email" />
		<result property="site" column="www" />
		<result property="cel1" column="fone" />
		<result property="cel2" column="fone" />
		<result property="codpais" column="codpais" />
		<result property="codmunic" column="codmunic" />
<!--  	<result property="siglauf" column="siglauf" />
		<result property="dtins" column="dtins" />
		<result property="hins" column="hins" />
		<result property="idusuins" column="idusuins" />
		<result property="dtalt" column="dtalt" />
		<result property="halt" column="halt" />
		<result property="idusualt" column="idusualt" />-->
	</resultMap>

	<sql id="allEmpresaColumms">
		SELECT codemp, razemp, nomeemp, cnpjemp, inscemp, codend, codean, multialmoxemp,
       fotoemp, codmunic, percissemp, dtins, hins, dtalt, halt, idusuins
	</sql>

	<!-- Fetch All Tags -->
	<select id="fetchAllEmpresas" parameterType="Map" resultMap="EmpresasResult">

		SELECT codemp, razemp, nomeemp, cnpjemp, inscemp, codend, codean, multialmoxemp,
       fotoemp, codmunic, percissemp, dtins, hins, dtalt, halt, idusuins
  FROM empresa;

	</select>

	<select id="fetchAllFiliaisById"  parameterType="Map" resultMap="FilialResult">

		select f.*
			from filial f ,empresa e
			where
				f.codemp = e.codemp and
				f.codemp = #{codemp}

	</select>

		<select id="fetchAllEnderecoByFilial"  resultMap="EnderecoResult">

			select e.*
			from filial f
				inner join endereco e on
					(f.codend = e.codend and f.codfilial = #{codfilial} )

		</select>

	<select id="fetchAllEnderecoByEmpresa"  resultMap="EnderecoResult">

			select n.*
			from empresa e
			left join endereco n on
				(e.codend = n.codend and e.codemp = #{codemp})

	</select>

		<!-- Insert Empresa -->
	<select id="insertEmpresa" parameterType="Empresa" resultType="int">
	SELECT ins_empresa (
		#{emdemp,jdbcType=VARCHAR},
		#{numemp,jdbcType=INTEGER},
		#{complemp,jdbcType=VARCHAR},
		#{bairemp,jdbcType=VARCHAR},
		#{cepemp,jdbcType=VARCHAR},
		#{cidemp,jdbcType=VARCHAR},
		#{ufemp,jdbcType=VARCHAR},
		#{dddemp,jdbcType=VARCHAR},
		#{foneemp,jdbcType=VARCHAR},
		#{faxemp,jdbcType=VARCHAR},
		#{emailemp,jdbcType=VARCHAR},
		#{wwwemp,jdbcType=VARCHAR},
		#{nomecontemp,jdbcType=VARCHAR},
		#{siglauf,jdbcType=VARCHAR},
		#{codmunic,jdbcType=VARCHAR},
		#{codpais,jdbcType=VARCHAR},
		#{razemp,jdbcType=VARCHAR},
		#{nomeemp,jdbcType=VARCHAR},
		#{cnpjemp,jdbcType=VARCHAR},
		#{inscemp,jdbcType=VARCHAR},
		#{codeanemp,jdbcType=VARCHAR},
		#{multialmoxemp,jdbcType=VARCHAR},
		#{fotoemp,jdbcType=VARCHAR},
		#{codmunic,jdbcType=VARCHAR},
		#{percissemp,jdbcType=DOUBLE})
	</select>

		<select id="insertEndereco" parameterType="Empresa" resultType="int">
		 SELECT ins_endereco(
		 				#{emdemp,jdbcType=VARCHAR},
				        #{numemp,jdbcType=INTEGER},
				        #{complemp,jdbcType=VARCHAR},
				        #{bairemp,jdbcType=VARCHAR},
				        #{cepemp,jdbcType=VARCHAR},
				        #{cidemp,jdbcType=VARCHAR},
				        #{ufemp,jdbcType=VARCHAR},
				        #{dddemp,jdbcType=VARCHAR},
				        #{foneemp,jdbcType=VARCHAR},
				        #{faxemp,jdbcType=VARCHAR},
				        #{emailemp,jdbcType=VARCHAR},
				        #{wwwemp,jdbcType=VARCHAR},
				        #{nomecontemp,jdbcType=VARCHAR},
				        #{siglauf,jdbcType=VARCHAR},
				        #{codmunic,jdbcType=VARCHAR},
				        #{codpais,jdbcType=VARCHAR})
	</select>

</mapper>

